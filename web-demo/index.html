<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>SVIT Helpdesk Bot ðŸŽ“</title>

<style>
/* ---------- base ---------- */
:root{
  --bg:#e9eef5;
  --card:#fff;
  --muted:#6b7280;
  --primary:#007aff;
  --bot-bg:#e4f1ff;
  --user-bg:#cfe3ff;
}
*{box-sizing:border-box}
body{margin:0;background:var(--bg);display:flex;justify-content:center;padding:22px;font-family:Inter,system-ui,Arial;}

.chat-wrap{
  width:100%;max-width:880px;height:88vh;background:var(--card);border-radius:16px;display:flex;flex-direction:column;
  box-shadow:0 18px 40px rgba(9,30,66,0.08);overflow:hidden;
}

/* header */
.header{
  display:flex;align-items:center;justify-content:space-between;padding:18px 22px;background:linear-gradient(90deg,#0663d9,#0a9bff);color:#fff;
  border-radius:12px 12px 0 0;
}
.header .title{font-weight:700;font-size:20px}
.header small{display:block;font-weight:500;opacity:.92;font-size:13px}

/* chat area */
.chat{
  flex:1;padding:20px;overflow:auto;display:flex;flex-direction:column;gap:14px;
  scroll-behavior:smooth;
}

/* bubbles */
.msg {
  max-width:78%;
  padding:14px 16px;border-radius:14px;font-size:15px;line-height:1.35;
  box-shadow: 0 8px 20px rgba(9,30,66,0.04);
  white-space:pre-line;
}
.bot { background:var(--bot-bg); color:#02203c; align-self:flex-start; }
.user { background:var(--user-bg); color:#02203c; align-self:flex-end; }

/* avatars */
.row { display:flex; gap:12px; align-items:flex-end; }
.right { justify-content:flex-end; }
.avatar{
  width:44px;height:44px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-weight:700;
  background:#fff;color:var(--primary);box-shadow:0 8px 20px rgba(9,30,66,0.05);
  flex-shrink:0;font-size:16px;
}

/* chips */
.chips-wrap{
  position:sticky;bottom:86px;display:flex;justify-content:center;padding:12px 18px;z-index:40;
}
.chips{display:flex;gap:10px;flex-wrap:wrap;justify-content:center;max-width:100%;}
.chip{
  background:#eef6ff;border-radius:999px;padding:10px 18px;border:0;font-weight:700;color:#004a9f;cursor:pointer;
  opacity:0;transform:translateY(20px);box-shadow:0 8px 20px rgba(9,30,66,0.06);
}
.chip.enter{ animation:chipIn .36s forwards; }
@keyframes chipIn{ to{ opacity:1; transform:translateY(0); } }

/* input */
.input-wrap{ padding:14px 20px; }
.input{
  display:flex;gap:12px;background:#fff;border-radius:999px;padding:10px 12px;box-shadow:0 8px 28px rgba(9,30,66,0.06);
}
.input input{ flex:1;border:0;outline:none;padding:12px 10px;border-radius:999px;font-size:15px;background:transparent }
.btn{ background:var(--primary);color:#fff;border:none;padding:10px 16px;border-radius:12px;cursor:pointer;font-weight:700; }

/* typing */
.typing{ display:inline-flex;gap:6px;padding:10px;border-radius:12px;background:var(--bot-bg); }
.typing i{ width:8px;height:8px;border-radius:50%;background:#789; animation:pulse 1s infinite; }
.typing i:nth-child(2){ animation-delay:.15s } 
.typing i:nth-child(3){ animation-delay:.3s }
@keyframes pulse{ 50%{transform:translateY(-6px);opacity:.4} }

/* dark mode */
body.dark{ background:#061324 }
body.dark .chat-wrap{ background:#071421 }
body.dark .bot{ background:#0f2b3d;color:#e7f6ff }
body.dark .user{ background:#064b7a;color:white }
body.dark .chip{ background:#0b2d42;color:#bfe8ff;box-shadow:none }

/* mobile */
@media(max-width:520px){
  .header .title{font-size:18px}
  .chat{ padding:12px }
  .chip{ font-size:13px }
}
</style>
</head>
<body>

<div class="chat-wrap">
  <div class="header">
    <div>
      <div class="title">SVIT Helpdesk Bot ðŸŽ“</div>
      <small>Your Campus Info Assistant</small>
    </div>
    <button id="themeBtn" style="border-radius:50%;width:36px;height:36px;border:0;background:#fff;cursor:pointer">ðŸŒ™</button>
  </div>

  <div id="chat" class="chat"></div>

  <div class="chips-wrap"><div id="chips" class="chips"></div></div>

  <div class="input-wrap">
    <div class="input">
      <input id="input" placeholder="Ask something or choose below..." />
      <button id="send" class="btn">Send</button>
    </div>
  </div>
</div>

<script>
const WEBHOOK = "https://svit-helpdesk-bot1.onrender.com/webhook";
const MAIN_CHIPS = [
  "Admissions","Courses","Fees","Events",
  "Hostel","Transport","Library","Placement",
  "Exams/Results","Contact"
];
const COURSES = [
  "IT","CE","EC","Mechanical","Civil","Electrical",
  "Aeronautical","MCA","M.Tech","â¬… Back to Main"
];

const chatEl = document.getElementById("chat");
const chipsEl = document.getElementById("chips");
const inputEl = document.getElementById("input");
const history = JSON.parse(localStorage.getItem("svit_hist") || "[]");

/* CHAT RENDER */
function bubble(txt,who="bot"){
  const row=document.createElement("div");
  row.className="row "+(who==="bot"?"left":"right");
  const a=document.createElement("div");
  a.className="avatar"; a.textContent=who==="bot"?"SV":"YOU";
  const m=document.createElement("div");
  m.className="msg "+who; m.innerText=txt;
  row.append(a,m); chatEl.append(row);
  chatEl.scrollTop=chatEl.scrollHeight;
  history.push({who,txt}); localStorage.setItem("svit_hist",JSON.stringify(history));
}

/* CHIPS */
function showChips(list){
  chipsEl.innerHTML="";
  list.forEach((c,i)=>{
    const b=document.createElement("button");
    b.className="chip";
    b.innerText=c;
    setTimeout(()=>b.classList.add("enter"),50*i);
    b.onclick=()=>onChip(c);
    chipsEl.append(b);
  });
}

/* CHIP LOGIC */
function onChip(text){
  if(text==="Courses"){
    bubble(text,"user");
    bubble("ðŸŽ“ Select a department ðŸ‘‡","bot");
    return showChips(COURSES);
  }
  if(text==="â¬… Back to Main"){
    bubble(text,"user");
    bubble("ðŸ“Œ Main menu restored âœ…","bot");
    return showChips(MAIN_CHIPS);
  }
  bubble(text,"user");
  ask(text);
}

/* SEND TO BACKEND */
async function ask(q){
  try{
    const r=await fetch(WEBHOOK,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:q})});
    const j=await r.json();
    bubble(j.reply||"No data.","bot");
    showChips(MAIN_CHIPS);
  }catch(err){
    bubble("âš  Network Error â€” Backend offline.","bot");
  }
}

/* USER INPUT */
function send(){
  const t=inputEl.value.trim();
  if(!t) return;
  inputEl.value="";
  bubble(t,"user");
  ask(t);
}
document.getElementById("send").onclick=send;
inputEl.onkeypress=e=>e.key==="Enter"&&send();

/* THEME */
const themeBtn=document.getElementById("themeBtn");
themeBtn.onclick=()=>{
  const dark=document.body.classList.toggle("dark");
  themeBtn.textContent=dark?"â˜€ï¸":"ðŸŒ™";
};

/* INIT */
if(history.length){
  history.forEach(h=>bubble(h.txt,h.who));
}else{
  bubble("ðŸ‘‹ Hello! I'm your **SVIT Helpdesk Bot**.","bot");
  bubble("âœ… I can help with:\n- Admissions\n- Courses\n- Fees\n- Events\n- Placement\n\nðŸ‘‡ Start by selecting a topic below","bot");
}
showChips(MAIN_CHIPS);
</script>

</body>
</html>
